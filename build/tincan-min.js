
/*!
    Copyright 2012 Rustici Software

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
*/
;var TinCan;(function(){"use strict";var _environment=null,_reservedQSParams={statementId:!0,voidedStatementId:!0,verb:!0,object:!0,registration:!0,context:!0,actor:!0,since:!0,until:!0,limit:!0,authoritative:!0,sparse:!0,instructor:!0,ascending:!0,continueToken:!0,agent:!0,activityId:!0,stateId:!0,profileId:!0,activity_platform:!0,grouping:!0,"Accept-Language":!0};TinCan=function(e){this.log("constructor"),this.environment=null,this.recordStores=[],this.actor=null,this.activity=null,this.registration=null,this.context=null,this.init(e)},TinCan.prototype={LOG_SRC:"TinCan",log:function(e,t){TinCan.DEBUG&&typeof console!="undefined"&&console.log&&(t=t||this.LOG_SRC||"TinCan",console.log("TinCan."+t+": "+e))},init:function(e){this.log("init");var t;e=e||{},e.hasOwnProperty("url")&&e.url!==""&&this._initFromQueryString(e.url);if(e.hasOwnProperty("recordStores")&&e.recordStores!==undefined)for(t=0;t<e.recordStores.length;t+=1)this.addRecordStore(e.recordStores[t]);e.hasOwnProperty("activity")&&(e.activity instanceof TinCan.Activity?this.activity=e.activity:this.activity=new TinCan.Activity(e.activity)),e.hasOwnProperty("actor")&&(e.actor instanceof TinCan.Agent?this.actor=e.actor:this.actor=new TinCan.Agent(e.actor)),e.hasOwnProperty("context")&&(e.context instanceof TinCan.Context?this.context=e.context:this.context=new TinCan.Context(e.context)),e.hasOwnProperty("registration")&&(this.registration=e.registration)},_initFromQueryString:function(e){this.log("_initFromQueryString");var t,n,r=TinCan.Utils.parseURL(e).params,i=["endpoint","auth"],s={},o,u,a=null;if(r.hasOwnProperty("actor")){this.log("_initFromQueryString - found actor: "+r.actor);try{this.actor=TinCan.Agent.fromJSON(r.actor),delete r.actor}catch(f){this.log("_initFromQueryString - failed to set actor: "+f)}}r.hasOwnProperty("activity_id")&&(this.activity=new TinCan.Activity({id:r.activity_id}),delete r.activity_id);if(r.hasOwnProperty("activity_platform")||r.hasOwnProperty("registration")||r.hasOwnProperty("grouping"))u={},r.hasOwnProperty("activity_platform")&&(u.platform=r.activity_platform,delete r.activity_platform),r.hasOwnProperty("registration")&&(u.registration=this.registration=r.registration,delete r.registration),r.hasOwnProperty("grouping")&&(u.contextActivities={},u.contextActivities.grouping=r.grouping,delete r.grouping),this.context=new TinCan.Context(u);if(r.hasOwnProperty("endpoint")){for(t=0;t<i.length;t+=1)n=i[t],r.hasOwnProperty(n)&&(s[n]=r[n],delete r[n]);for(t in r)r.hasOwnProperty(t)&&(_reservedQSParams.hasOwnProperty(t)?delete r[t]:(a=a||{},a[t]=r[t]));a!==null&&(s.extended=a),s.allowFail=!1,this.addRecordStore(s)}},addRecordStore:function(e){this.log("addRecordStore");var t;e instanceof TinCan.LRS?t=e:t=new TinCan.LRS(e),this.recordStores.push(t)},prepareStatement:function(e){return this.log("prepareStatement"),e instanceof TinCan.Statement||(e=new TinCan.Statement(e)),e.actor===null&&this.actor!==null&&(e.actor=this.actor),e.target===null&&this.activity!==null&&(e.target=this.activity),this.context!==null&&(e.context===null?e.context=this.context:(e.context.registration===null&&(e.context.registration=this.context.registration),e.context.platform===null&&(e.context.platform=this.context.platform),this.context.contextActivities!==null&&(e.context.contextActivities===null?e.context.contextActivities=this.context.contextActivities:(this.context.contextActivities.grouping!==null&&e.context.contextActivities.grouping===null&&(e.context.contextActivities.grouping=this.context.contextActivities.grouping),this.context.contextActivities.parent!==null&&e.context.contextActivities.parent===null&&(e.context.contextActivities.parent=this.context.contextActivities.parent),this.context.contextActivities.other!==null&&e.context.contextActivities.other===null&&(e.context.contextActivities.other=this.context.contextActivities.other))))),e},sendStatement:function(e,t){this.log("sendStatement");var n=this,r,i=this.prepareStatement(e),s=this.recordStores.length,o,u,a=[],f,l=[];if(s>0){typeof t=="function"&&(f=function(e,r){var o;n.log("sendStatement - callbackWrapper: "+s),s>1?(s-=1,l.push({err:e,xhr:r})):s===1?(l.push({err:e,xhr:r}),o=[l,i],t.apply(this,o)):n.log("sendStatement - unexpected record store count: "+s)});for(o=0;o<s;o+=1)r=this.recordStores[o],a.push(r.saveStatement(i,{callback:f}))}else u="[warning] sendStatement: No LRSs added yet (statement not sent)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+u):this.log(u),typeof t=="function"&&t.apply(this,[null,i]);return{statement:i,results:a}},getStatement:function(e,t){this.log("getStatement");var n,r;if(this.recordStores.length>0)return n=this.recordStores[0],n.retrieveStatement(e,{callback:t});r="[warning] getStatement: No LRSs added yet (statement not retrieved)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+r):this.log(r)},voidStatement:function(e,t,n){this.log("voidStatement");var r=this,i,s,o,u=this.recordStores.length,a,f,l=[],c,h=[];e instanceof TinCan.Statement&&(e=e.id),typeof n.actor!="undefined"?s=n.actor:this.actor!==null&&(s=this.actor),o=new TinCan.Statement({actor:s,verb:{id:"http://adlnet.gov/expapi/verbs/voided"},target:{objectType:"StatementRef",id:e}});if(u>0){typeof t=="function"&&(c=function(e,n){var i;r.log("voidStatement - callbackWrapper: "+u),u>1?(u-=1,h.push({err:e,xhr:n})):u===1?(h.push({err:e,xhr:n}),i=[h,o],t.apply(this,i)):r.log("voidStatement - unexpected record store count: "+u)});for(a=0;a<u;a+=1)i=this.recordStores[a],l.push(i.saveStatement(o,{callback:c}))}else f="[warning] voidStatement: No LRSs added yet (statement not sent)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+f):this.log(f),typeof t=="function"&&t.apply(this,[null,o]);return{statement:o,results:l}},getVoidedStatement:function(e,t){this.log("getVoidedStatement");var n,r;if(this.recordStores.length>0)return n=this.recordStores[0],n.retrieveVoidedStatement(e,{callback:t});r="[warning] getVoidedStatement: No LRSs added yet (statement not retrieved)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+r):this.log(r)},sendStatements:function(e,t){this.log("sendStatements");var n=this,r,i=[],s=this.recordStores.length,o,u,a=[],f,l=[];if(e.length===0)typeof t=="function"&&t.apply(this,[null,i]);else{for(o=0;o<e.length;o+=1)i.push(this.prepareStatement(e[o]));if(s>0){typeof t=="function"&&(f=function(e,r){var o;n.log("sendStatements - callbackWrapper: "+s),s>1?(s-=1,l.push({err:e,xhr:r})):s===1?(l.push({err:e,xhr:r}),o=[l,i],t.apply(this,o)):n.log("sendStatements - unexpected record store count: "+s)});for(o=0;o<s;o+=1)r=this.recordStores[o],a.push(r.saveStatements(i,{callback:f}))}else u="[warning] sendStatements: No LRSs added yet (statements not sent)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+u):this.log(u),typeof t=="function"&&t.apply(this,[null,i])}return{statements:i,results:a}},getStatements:function(e){this.log("getStatements");var t={},n,r,i;if(this.recordStores.length>0)return n=this.recordStores[0],e=e||{},r=e.params||{},e.sendActor&&this.actor!==null&&(n.version==="0.9"||n.version==="0.95"?r.actor=this.actor:r.agent=this.actor),e.sendActivity&&this.activity!==null&&(n.version==="0.9"||n.version==="0.95"?r.target=this.activity:r.activity=this.activity),typeof r.registration=="undefined"&&this.registration!==null&&(r.registration=this.registration),t={params:r},typeof e.callback!="undefined"&&(t.callback=e.callback),n.queryStatements(t);i="[warning] getStatements: No LRSs added yet (statements not read)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+i):this.log(i)},getState:function(e,t){this.log("getState");var n,r,i;if(this.recordStores.length>0)return r=this.recordStores[0],t=t||{},n={agent:typeof t.agent!="undefined"?t.agent:this.actor,activity:typeof t.activity!="undefined"?t.activity:this.activity},typeof t.registration!="undefined"?n.registration=t.registration:this.registration!==null&&(n.registration=this.registration),typeof t.callback!="undefined"&&(n.callback=t.callback),r.retrieveState(e,n);i="[warning] getState: No LRSs added yet (state not retrieved)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+i):this.log(i)},setState:function(e,t,n){this.log("setState");var r,i,s;if(this.recordStores.length>0)return i=this.recordStores[0],n=n||{},r={agent:typeof n.agent!="undefined"?n.agent:this.actor,activity:typeof n.activity!="undefined"?n.activity:this.activity},typeof n.registration!="undefined"?r.registration=n.registration:this.registration!==null&&(r.registration=this.registration),typeof n.lastSHA1!="undefined"&&(r.lastSHA1=n.lastSHA1),typeof n.contentType!="undefined"&&(r.contentType=n.contentType),typeof n.callback!="undefined"&&(r.callback=n.callback),i.saveState(e,t,r);s="[warning] setState: No LRSs added yet (state not saved)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+s):this.log(s)},deleteState:function(e,t){this.log("deleteState");var n,r,i;if(this.recordStores.length>0)return r=this.recordStores[0],t=t||{},n={agent:typeof t.agent!="undefined"?t.agent:this.actor,activity:typeof t.activity!="undefined"?t.activity:this.activity},typeof t.registration!="undefined"?n.registration=t.registration:this.registration!==null&&(n.registration=this.registration),typeof t.callback!="undefined"&&(n.callback=t.callback),r.dropState(e,n);i="[warning] deleteState: No LRSs added yet (state not deleted)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+i):this.log(i)},getActivityProfile:function(e,t){this.log("getActivityProfile");var n,r,i;if(this.recordStores.length>0)return r=this.recordStores[0],t=t||{},n={activity:typeof t.activity!="undefined"?t.activity:this.activity},typeof t.callback!="undefined"&&(n.callback=t.callback),r.retrieveActivityProfile(e,n);i="[warning] getActivityProfile: No LRSs added yet (activity profile not retrieved)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+i):this.log(i)},setActivityProfile:function(e,t,n){this.log("setActivityProfile");var r,i,s;if(this.recordStores.length>0)return i=this.recordStores[0],n=n||{},r={activity:typeof n.activity!="undefined"?n.activity:this.activity},typeof n.callback!="undefined"&&(r.callback=n.callback),typeof n.lastSHA1!="undefined"&&(r.lastSHA1=n.lastSHA1),typeof n.contentType!="undefined"&&(r.contentType=n.contentType),i.saveActivityProfile(e,t,r);s="[warning] setActivityProfile: No LRSs added yet (activity profile not saved)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+s):this.log(s)},deleteActivityProfile:function(e,t){this.log("deleteActivityProfile");var n,r,i;if(this.recordStores.length>0)return r=this.recordStores[0],t=t||{},n={activity:typeof t.activity!="undefined"?t.activity:this.activity},typeof t.callback!="undefined"&&(n.callback=t.callback),r.dropActivityProfile(e,n);i="[warning] deleteActivityProfile: No LRSs added yet (activity profile not deleted)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+i):this.log(i)},getAgentProfile:function(e,t){this.log("getAgentProfile");var n,r,i;if(this.recordStores.length>0)return r=this.recordStores[0],t=t||{},n={agent:typeof t.agent!="undefined"?t.agent:this.actor},typeof t.callback!="undefined"&&(n.callback=t.callback),r.retrieveAgentProfile(e,n);i="[warning] getAgentProfile: No LRSs added yet (agent profile not retrieved)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+i):this.log(i)},setAgentProfile:function(e,t,n){this.log("setAgentProfile");var r,i,s;if(this.recordStores.length>0)return i=this.recordStores[0],n=n||{},r={agent:typeof n.agent!="undefined"?n.agent:this.actor},typeof n.callback!="undefined"&&(r.callback=n.callback),typeof n.lastSHA1!="undefined"&&(r.lastSHA1=n.lastSHA1),typeof n.contentType!="undefined"&&(r.contentType=n.contentType),i.saveAgentProfile(e,t,r);s="[warning] setAgentProfile: No LRSs added yet (agent profile not saved)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+s):this.log(s)},deleteAgentProfile:function(e,t){this.log("deleteAgentProfile");var n,r,i;if(this.recordStores.length>0)return r=this.recordStores[0],t=t||{},n={agent:typeof t.agent!="undefined"?t.agent:this.actor},typeof t.callback!="undefined"&&(n.callback=t.callback),r.dropAgentProfile(e,n);i="[warning] deleteAgentProfile: No LRSs added yet (agent profile not deleted)",TinCan.environment().isBrowser?alert(this.LOG_SRC+": "+i):this.log(i)}},TinCan.DEBUG=!1,TinCan.enableDebug=function(){TinCan.DEBUG=!0},TinCan.disableDebug=function(){TinCan.DEBUG=!1},TinCan.versions=function(){return["1.0.1","1.0.0","0.95","0.9"]},TinCan.environment=function(){return _environment===null&&(_environment={},typeof window!="undefined"?(_environment.isBrowser=!0,_environment.hasCORS=!1,_environment.useXDR=!1,typeof XMLHttpRequest!="undefined"&&typeof (new XMLHttpRequest).withCredentials!="undefined"?_environment.hasCORS=!0:typeof XDomainRequest!="undefined"&&(_environment.hasCORS=!0,_environment.useXDR=!0)):_environment.isBrowser=!1),_environment},TinCan.environment().isBrowser&&(window.JSON||(window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(e){var t="",n,r;if(e instanceof Object){if(e.constructor===Array){for(n=0;n<e.length;n+=1)t+=this.stringify(e[n])+",";return"["+t.substr(0,t.length-1)+"]"}if(e.toString!==Object.prototype.toString)return'"'+e.toString().replace(/"/g,"\\$&")+'"';for(r in e)e.hasOwnProperty(r)&&(t+='"'+r.replace(/"/g,"\\$&")+'":'+this.stringify(e[r])+",");return"{"+t.substr(0,t.length-1)+"}"}return typeof e=="string"?'"'+e.replace(/"/g,"\\$&")+'"':String(e)}}),Date.now||(Date.now=function(){return+(new Date)}))})(),function(){"use strict";TinCan.Utils={getUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})},getISODateString:function(e){function t(e,t){var n,r;if(typeof e=="undefined"||e===null)e=0;if(typeof t=="undefined"||t===null)t=2;n=Math.pow(10,t-1),r=e.toString();while(e<n&&n>1)r="0"+r,n/=10;return r}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+t(e.getUTCMilliseconds(),3)+"Z"},getSHA1String:function(e){return CryptoJS.SHA1(e).toString(CryptoJS.enc.Hex)},getBase64String:function(e){return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Latin1.parse(e))},getLangDictionaryValue:function(e,t){var n=this[e],r;if(typeof t!="undefined"&&typeof n[t]!="undefined")return n[t];if(typeof n.und!="undefined")return n.und;if(typeof n["en-US"]!="undefined")return n["en-US"];for(r in n)if(n.hasOwnProperty(r))return n[r];return""},parseURL:function(e){var t=String(e).split("?"),n,r,i,s={};if(t.length===2){n=t[1].split("&");for(i=0;i<n.length;i+=1)r=n[i].split("="),r.length===2&&r[0]&&(s[r[0]]=decodeURIComponent(r[1]))}return{path:t[0],params:s}},getServerRoot:function(e){var t=e.split("/");return t[0]+"//"+t[2]},getContentTypeFromHeader:function(e){return String(e).split(";")[0]},isApplicationJSON:function(e){return TinCan.Utils.getContentTypeFromHeader(e).toLowerCase().indexOf("application/json")===0}}}(),function(){"use strict";var e="xdr",t="native",n=TinCan.LRS=function(e){this.log("constructor"),this.endpoint=null,this.version=null,this.auth=null,this.allowFail=!0,this.alertOnRequestFailure=!0,this.extended=null,this._requestMode=t,this.init(e)};n.prototype={LOG_SRC:"LRS",log:TinCan.prototype.log,init:function(t){this.log("init");var n,r,i,s,o=TinCan.environment(),u=TinCan.versions(),a=!1,f;t=t||{},t.hasOwnProperty("alertOnRequestFailure")&&(this.alertOnRequestFailure=t.alertOnRequestFailure);if(!t.hasOwnProperty("endpoint"))throw o.isBrowser&&this.alertOnRequestFailure&&alert("[error] LRS invalid: no endpoint"),{code:3,mesg:"LRS invalid: no endpoint"};this.endpoint=t.endpoint,this.endpoint.slice(-1)!=="/"&&(this.log("adding trailing slash to endpoint"),this.endpoint+="/"),t.hasOwnProperty("allowFail")&&(this.allowFail=t.allowFail),t.hasOwnProperty("auth")?this.auth=t.auth:t.hasOwnProperty("username")&&t.hasOwnProperty("password")&&(this.auth="Basic "+TinCan.Utils.getBase64String(t.username+":"+t.password)),t.hasOwnProperty("extended")&&(this.extended=t.extended);if(o.isBrowser){n=this.endpoint.toLowerCase().match(/([A-Za-z]+:)\/\/([^:\/]+):?(\d+)?(\/.*)?$/);if(n===null)throw this.alertOnRequestFailure&&alert("[error] LRS invalid: failed to divide URL parts"),{code:4,mesg:"LRS invalid: failed to divide URL parts"};i=location.port,r=location.protocol.toLowerCase()===n[1],i===""&&(i=location.protocol.toLowerCase()==="http:"?"80":location.protocol.toLowerCase()==="https:"?"443":""),s=!r||location.hostname.toLowerCase()!==n[2]||i!==(n[3]!==null&&typeof n[3]!="undefined"&&n[3]!==""?n[3]:n[1]==="http:"?"80":n[1]==="https:"?"443":"");if(s)if(o.hasCORS){if(o.useXDR&&r)this._requestMode=e;else if(o.useXDR&&!r){if(!t.allowFail)throw this.alertOnRequestFailure&&alert("[error] LRS invalid: cross domain request for differing scheme in IE with XDR"),{code:2,mesg:"LRS invalid: cross domain request for differing scheme in IE with XDR"};this.alertOnRequestFailure&&alert("[warning] LRS invalid: cross domain request for differing scheme in IE with XDR")}}else{if(!t.allowFail)throw this.alertOnRequestFailure&&alert("[error] LRS invalid: cross domain requests not supported in this browser"),{code:1,mesg:"LRS invalid: cross domain requests not supported in this browser"};this.alertOnRequestFailure&&alert("[warning] LRS invalid: cross domain requests not supported in this browser")}}else this.log("Unrecognized environment not supported: "+o);if(typeof t.version!="undefined"){this.log("version: "+t.version);for(f=0;f<u.length;f+=1)if(u[f]===t.version){a=!0;break}if(!a)throw o.isBrowser&&this.alertOnRequestFailure&&alert("[error] LRS invalid: version not supported ("+t.version+")"),{code:5,mesg:"LRS invalid: version not supported ("+t.version+")"};this.version=t.version}else this.version=u[0]},sendRequest:function(n){function v(e){d.log("requestComplete: "+i+", xhr.status: "+r.status);var t,s,o,u,a,l;typeof r.status=="undefined"?s=e:s=r.status===1223?204:r.status;if(!!i)return f;i=!0,t=n.ignore404&&s===404;if(!(s>=200&&s<400||t))return f={err:s,xhr:r},d.alertOnRequestFailure&&(s===0?alert("[warning] There was a problem communicating with the Learning Record Store. Aborted, offline, or invalid CORS endpoint ("+s+")"):alert("[warning] There was a problem communicating with the Learning Record Store. ("+s+" | "+r.responseText+")")),n.callback&&n.callback(s,r),o=window.tincan.actor.mbox_sha1sum,u=localStorage.getItem(o),u?u=JSON.parse(u):u={},a="noid",n.params?a=n.params.statementId:(l=JSON.parse(n.data),typeof l[0]=="object"&&(a=l[0].id)),u.hasOwnProperty(a)||(u[a]={lrs:d,cfg:n},localStorage.setItem(o,JSON.stringify(u))),f;if(!n.callback)return f={err:null,xhr:r},f;n.callback(null,r)}this.log("sendRequest");var r,i=!1,s=window.location,o=this.endpoint+n.url,u={},a,f,l,c,h,p=[],d=this;n.url.indexOf("http")===0&&(o=n.url);if(this.extended!==null){n.params=n.params||{};for(h in this.extended)this.extended.hasOwnProperty(h)&&(n.params.hasOwnProperty(h)||this.extended[h]!==null&&(n.params[h]=this.extended[h]))}u.Authorization=this.auth,this.version!=="0.9"&&(u["X-Experience-API-Version"]=this.version);for(h in n.headers)n.headers.hasOwnProperty(h)&&(u[h]=n.headers[h]);if(this._requestMode===t){this.log("sendRequest using XMLHttpRequest");for(h in n.params)n.params.hasOwnProperty(h)&&p.push(h+"="+encodeURIComponent(n.params[h]));p.length>0&&(o+="?"+p.join("&")),this.log("sendRequest using XMLHttpRequest - async: "+(typeof n.callback!="undefined")),typeof XMLHttpRequest!="undefined"?r=new XMLHttpRequest:r=new ActiveXObject("Microsoft.XMLHTTP"),r.open(n.method,o,typeof n.callback!="undefined");for(h in u)u.hasOwnProperty(h)&&r.setRequestHeader(h,u[h]);typeof n.data!="undefined"&&(n.data+=""),a=n.data,r.onreadystatechange=function(){d.log("xhr.onreadystatechange - xhr.readyState: "+r.readyState),r.readyState===4&&v()}}else if(this._requestMode===e){this.log("sendRequest using XDomainRequest"),o+="?method="+n.method;for(h in n.params)n.params.hasOwnProperty(h)&&p.push(h+"="+encodeURIComponent(n.params[h]));for(h in u)u.hasOwnProperty(h)&&p.push(h+"="+encodeURIComponent(u[h]));n.data!==null&&p.push("content="+encodeURIComponent(n.data)),a=p.join("&"),r=new XDomainRequest,r.open("POST",o),n.callback?(r.onload=function(){v(200)},r.onerror=function(){v(400)},r.ontimeout=function(){v(0)}):(r.onload=function(){l=200},r.onerror=function(){l=400},r.ontimeout=function(){l=0}),r.onprogress=function(){},r.timeout=0}else this.log("sendRequest unrecognized _requestMode: "+this._requestMode);try{r.send(a)}catch(m){this.log("sendRequest caught send exception: "+m)}if(!n.callback){if(this._requestMode===e){c=1e4+Date.now(),this.log("sendRequest - until: "+c+", finished: "+i);while(Date.now()<c&&typeof l=="undefined")this.__delay();return v(l)}return v()}return r},saveStatement:function(e,t){this.log("saveStatement");var n;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return t=t||{},n={url:"statements",data:JSON.stringify(e.asVersion(this.version)),headers:{"Content-Type":"application/json"}},e.id!==null?(n.method="PUT",n.params={statementId:e.id}):n.method="POST",typeof t.callback!="undefined"&&(n.callback=t.callback),this.sendRequest(n)},retrieveStatement:function(e,t){this.log("retrieveStatement");var n,r,i;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return t=t||{},n={url:"statements",method:"GET",params:{statementId:e}},typeof t.callback!="undefined"&&(i=function(e,n){var r=n;e===null&&(r=TinCan.Statement.fromJSON(n.responseText)),t.callback(e,r)},n.callback=i),r=this.sendRequest(n),i||(r.statement=null,r.err===null&&(r.statement=TinCan.Statement.fromJSON(r.xhr.responseText))),r},retrieveVoidedStatement:function(e,t){this.log("retrieveStatement");var n,r,i;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return t=t||{},n={url:"statements",method:"GET",params:{}},this.version==="0.9"||this.version==="0.95"?n.params.statementId=e:n.params.voidedStatementId=e,typeof t.callback!="undefined"&&(i=function(e,n){var r=n;e===null&&(r=TinCan.Statement.fromJSON(n.responseText)),t.callback(e,r)},n.callback=i),r=this.sendRequest(n),i||(r.statement=null,r.err===null&&(r.statement=TinCan.Statement.fromJSON(r.xhr.responseText))),r},saveStatements:function(e,t){this.log("saveStatements");var n,r=[],i;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}t=t||{};if(e.length===0){typeof t.callback!="undefined"&&t.callback.apply(this,["no statements"]);return}for(i=0;i<e.length;i+=1)r.push(e[i].asVersion(this.version));return n={url:"statements",method:"POST",data:JSON.stringify(r),headers:{"Content-Type":"application/json"}},typeof t.callback!="undefined"&&(n.callback=t.callback),this.sendRequest(n)},queryStatements:function(e){this.log("queryStatements");var t,n,r;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}e=e||{},e.params=e.params||{};try{t=this._queryStatementsRequestCfg(e)}catch(i){return TinCan.environment().isBrowser&&this.alertOnRequestFailure&&alert("[error] Query statements failed - "+i),typeof e.callback!="undefined"&&e.callback(i,{}),{err:i,statementsResult:null}}return typeof e.callback!="undefined"&&(r=function(t,n){var r=n;t===null&&(r=TinCan.StatementsResult.fromJSON(n.responseText)),e.callback(t,r)},t.callback=r),n=this.sendRequest(t),n.config=t,r||(n.statementsResult=null,n.err===null&&(n.statementsResult=TinCan.StatementsResult.fromJSON(n.xhr.responseText))),n},_queryStatementsRequestCfg:function(e){this.log("_queryStatementsRequestCfg");var t={},n={url:"statements",method:"GET",params:t},r=["agent","actor","object","instructor"],i=["verb","activity"],s=["registration","context","since","until","limit","authoritative","sparse","ascending","related_activities","related_agents","format","attachments"],o,u,a={verb:!0,registration:!0,since:!0,until:!0,limit:!0,ascending:!0},f={.9:{supported:{actor:!0,instructor:!0,target:!0,object:!0,context:!0,authoritative:!0,sparse:!0}},"1.0.0":{supported:{agent:!0,activity:!0,related_activities:!0,related_agents:!0,format:!0,attachments:!0}}};f["0.95"]=f["0.9"],f["1.0.1"]=f["1.0.0"],e.params.hasOwnProperty("target")&&(e.params.object=e.params.target);for(u in e.params)if(e.params.hasOwnProperty(u)&&typeof a[u]=="undefined"&&typeof f[this.version].supported[u]=="undefined")throw"Unrecognized query parameter configured: "+u;for(o=0;o<r.length;o+=1)typeof e.params[r[o]]!="undefined"&&(t[r[o]]=JSON.stringify(e.params[r[o]].asVersion(this.version)));for(o=0;o<i.length;o+=1)typeof e.params[i[o]]!="undefined"&&(t[i[o]]=e.params[i[o]].id);for(o=0;o<s.length;o+=1)typeof e.params[s[o]]!="undefined"&&(t[s[o]]=e.params[s[o]]);return n},moreStatements:function(e){this.log("moreStatements: "+e.url);var t,n,r,i,s;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return e=e||{},i=TinCan.Utils.parseURL(e.url),s=TinCan.Utils.getServerRoot(this.endpoint),i.path.indexOf("/statements")===0&&(i.path=this.endpoint.replace(s,"")+i.path,this.log("converting non-standard more URL to "+i.path)),i.path.indexOf("/")!==0&&(i.path="/"+i.path),t={method:"GET",url:s+i.path,params:i.params},typeof e.callback!="undefined"&&(r=function(t,n){var r=n;t===null&&(r=TinCan.StatementsResult.fromJSON(n.responseText)),e.callback(t,r)},t.callback=r),n=this.sendRequest(t),n.config=t,r||(n.statementsResult=null,n.err===null&&(n.statementsResult=TinCan.StatementsResult.fromJSON(n.xhr.responseText))),n},retrieveState:function(e,t){this.log("retrieveState");var n={},r={},i,s;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}n={stateId:e,activityId:t.activity.id},this.version==="0.9"?n.actor=JSON.stringify(t.agent.asVersion(this.version)):n.agent=JSON.stringify(t.agent.asVersion(this.version)),typeof t.registration!="undefined"&&(this.version==="0.9"?n.registrationId=t.registration:n.registration=t.registration),r={url:"activities/state",method:"GET",params:n,ignore404:!0},typeof t.callback!="undefined"&&(s=function(n,r){var i=r;if(n===null)if(r.status===404)i=null;else{i=new TinCan.State({id:e,contents:r.responseText}),typeof r.getResponseHeader!="undefined"&&r.getResponseHeader("ETag")!==null&&r.getResponseHeader("ETag")!==""?i.etag=r.getResponseHeader("ETag"):i.etag=TinCan.Utils.getSHA1String(r.responseText),typeof r.contentType!="undefined"?i.contentType=r.contentType:typeof r.getResponseHeader!="undefined"&&r.getResponseHeader("Content-Type")!==null&&r.getResponseHeader("Content-Type")!==""&&(i.contentType=r.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(i.contentType))try{i.contents=JSON.parse(i.contents)}catch(s){this.log("retrieveState - failed to deserialize JSON: "+s)}}t.callback(n,i)},r.callback=s),i=this.sendRequest(r);if(!s){i.state=null;if(i.err===null&&i.xhr.status!==404){i.state=new TinCan.State({id:e,contents:i.xhr.responseText}),typeof i.xhr.getResponseHeader!="undefined"&&i.xhr.getResponseHeader("ETag")!==null&&i.xhr.getResponseHeader("ETag")!==""?i.state.etag=i.xhr.getResponseHeader("ETag"):i.state.etag=TinCan.Utils.getSHA1String(i.xhr.responseText),typeof i.xhr.contentType!="undefined"?i.state.contentType=i.xhr.contentType:typeof i.xhr.getResponseHeader!="undefined"&&i.xhr.getResponseHeader("Content-Type")!==null&&i.xhr.getResponseHeader("Content-Type")!==""&&(i.state.contentType=i.xhr.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(i.state.contentType))try{i.state.contents=JSON.parse(i.state.contents)}catch(o){this.log("retrieveState - failed to deserialize JSON: "+o)}}}return i},saveState:function(e,t,n){this.log("saveState");var r,i,s;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return typeof n.contentType=="undefined"&&(n.contentType="application/octet-stream"),typeof t=="object"&&TinCan.Utils.isApplicationJSON(n.contentType)&&(t=JSON.stringify(t)),r={stateId:e,activityId:n.activity.id},this.version==="0.9"?r.actor=JSON.stringify(n.agent.asVersion(this.version)):r.agent=JSON.stringify(n.agent.asVersion(this.version)),typeof n.registration!="undefined"&&(this.version==="0.9"?r.registrationId=n.registration:r.registration=n.registration),i={url:"activities/state",method:"PUT",params:r,data:t,headers:{"Content-Type":n.contentType}},typeof n.callback!="undefined"&&(i.callback=n.callback),typeof n.lastSHA1!="undefined"&&n.lastSHA1!==null&&(i.headers["If-Match"]=n.lastSHA1),this.sendRequest(i)},dropState:function(e,t){this.log("dropState");var n,r;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return n={activityId:t.activity.id},this.version==="0.9"?n.actor=JSON.stringify(t.agent.asVersion(this.version)):n.agent=JSON.stringify(t.agent.asVersion(this.version)),e!==null&&(n.stateId=e),typeof t.registration!="undefined"&&(this.version==="0.9"?n.registrationId=t.registration:n.registration=t.registration),r={url:"activities/state",method:"DELETE",params:n},typeof t.callback!="undefined"&&(r.callback=t.callback),this.sendRequest(r)},retrieveActivityProfile:function(e,t){this.log("retrieveActivityProfile");var n={},r,i;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}n={url:"activities/profile",method:"GET",params:{profileId:e,activityId:t.activity.id},ignore404:!0},typeof t.callback!="undefined"&&(i=function(n,r){var i=r;if(n===null)if(r.status===404)i=null;else{i=new TinCan.ActivityProfile({id:e,activity:t.activity,contents:r.responseText}),typeof r.getResponseHeader!="undefined"&&r.getResponseHeader("ETag")!==null&&r.getResponseHeader("ETag")!==""?i.etag=r.getResponseHeader("ETag"):i.etag=TinCan.Utils.getSHA1String(r.responseText),typeof r.contentType!="undefined"?i.contentType=r.contentType:typeof r.getResponseHeader!="undefined"&&r.getResponseHeader("Content-Type")!==null&&r.getResponseHeader("Content-Type")!==""&&(i.contentType=r.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(i.contentType))try{i.contents=JSON.parse(i.contents)}catch(s){this.log("retrieveActivityProfile - failed to deserialize JSON: "+s)}}t.callback(n,i)},n.callback=i),r=this.sendRequest(n);if(!i){r.profile=null;if(r.err===null&&r.xhr.status!==404){r.profile=new TinCan.ActivityProfile({id:e,activity:t.activity,contents:r.xhr.responseText}),typeof r.xhr.getResponseHeader!="undefined"&&r.xhr.getResponseHeader("ETag")!==null&&r.xhr.getResponseHeader("ETag")!==""?r.profile.etag=r.xhr.getResponseHeader("ETag"):r.profile.etag=TinCan.Utils.getSHA1String(r.xhr.responseText),typeof r.xhr.contentType!="undefined"?r.profile.contentType=r.xhr.contentType:typeof r.xhr.getResponseHeader!="undefined"&&r.xhr.getResponseHeader("Content-Type")!==null&&r.xhr.getResponseHeader("Content-Type")!==""&&(r.profile.contentType=r.xhr.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(r.profile.contentType))try{r.profile.contents=JSON.parse(r.profile.contents)}catch(s){this.log("retrieveActivityProfile - failed to deserialize JSON: "+s)}}}return r},saveActivityProfile:function(e,t,n){this.log("saveActivityProfile");var r;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return typeof n.contentType=="undefined"&&(n.contentType="application/octet-stream"),typeof t=="object"&&TinCan.Utils.isApplicationJSON(n.contentType)&&(t=JSON.stringify(t)),r={url:"activities/profile",method:"PUT",params:{profileId:e,activityId:n.activity.id},data:t,headers:{"Content-Type":n.contentType}},typeof n.callback!="undefined"&&(r.callback=n.callback),typeof n.lastSHA1!="undefined"&&n.lastSHA1!==null?r.headers["If-Match"]=n.lastSHA1:r.headers["If-None-Match"]="*",this.sendRequest(r)},dropActivityProfile:function(e,t){this.log("dropActivityProfile");var n,r;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return n={profileId:e,activityId:t.activity.id},r={url:"activities/profile",method:"DELETE",params:n},typeof t.callback!="undefined"&&(r.callback=t.callback),this.sendRequest(r)},retrieveAgentProfile:function(e,t){this.log("retrieveAgentProfile");var n={},r,i;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}n={method:"GET",params:{profileId:e},ignore404:!0},this.version==="0.9"?(n.url="actors/profile",n.params.actor=JSON.stringify(t.agent.asVersion(this.version))):(n.url="agents/profile",n.params.agent=JSON.stringify(t.agent.asVersion(this.version))),typeof t.callback!="undefined"&&(i=function(n,r){var i=r;if(n===null)if(r.status===404)i=null;else{i=new TinCan.AgentProfile({id:e,agent:t.agent,contents:r.responseText}),typeof r.getResponseHeader!="undefined"&&r.getResponseHeader("ETag")!==null&&r.getResponseHeader("ETag")!==""?i.etag=r.getResponseHeader("ETag"):i.etag=TinCan.Utils.getSHA1String(r.responseText),typeof r.contentType!="undefined"?i.contentType=r.contentType:typeof r.getResponseHeader!="undefined"&&r.getResponseHeader("Content-Type")!==null&&r.getResponseHeader("Content-Type")!==""&&(i.contentType=r.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(i.contentType))try{i.contents=JSON.parse(i.contents)}catch(s){this.log("retrieveAgentProfile - failed to deserialize JSON: "+s)}}t.callback(n,i)},n.callback=i),r=this.sendRequest(n);if(!i){r.profile=null;if(r.err===null&&r.xhr.status!==404){r.profile=new TinCan.AgentProfile({id:e,agent:t.agent,contents:r.xhr.responseText}),typeof r.xhr.getResponseHeader!="undefined"&&r.xhr.getResponseHeader("ETag")!==null&&r.xhr.getResponseHeader("ETag")!==""?r.profile.etag=r.xhr.getResponseHeader("ETag"):r.profile.etag=TinCan.Utils.getSHA1String(r.xhr.responseText),typeof r.xhr.contentType!="undefined"?r.profile.contentType=r.xhr.contentType:typeof r.xhr.getResponseHeader!="undefined"&&r.xhr.getResponseHeader("Content-Type")!==null&&r.xhr.getResponseHeader("Content-Type")!==""&&(r.profile.contentType=r.xhr.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(r.profile.contentType))try{r.profile.contents=JSON.parse(r.profile.contents)}catch(s){this.log("retrieveAgentProfile - failed to deserialize JSON: "+s)}}}return r},saveAgentProfile:function(e,t,n){this.log("saveAgentProfile");var r;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return typeof n.contentType=="undefined"&&(n.contentType="application/octet-stream"),typeof t=="object"&&TinCan.Utils.isApplicationJSON(n.contentType)&&(t=JSON.stringify(t)),r={method:"PUT",params:{profileId:e},data:t,headers:{"Content-Type":n.contentType}},this.version==="0.9"?(r.url="actors/profile",r.params.actor=JSON.stringify(n.agent.asVersion(this.version))):(r.url="agents/profile",r.params.agent=JSON.stringify(n.agent.asVersion(this.version))),typeof n.callback!="undefined"&&(r.callback=n.callback),typeof n.lastSHA1!="undefined"&&n.lastSHA1!==null?r.headers["If-Match"]=n.lastSHA1:r.headers["If-None-Match"]="*",this.sendRequest(r)},dropAgentProfile:function(e,t){this.log("dropAgentProfile");var n,r;if(!TinCan.environment().isBrowser){this.log("error: environment not implemented");return}return n={profileId:e},r={method:"DELETE",params:n},this.version==="0.9"?(r.url="actors/profile",n.actor=JSON.stringify(t.agent.asVersion(this.version))):(r.url="agents/profile",n.agent=JSON.stringify(t.agent.asVersion(this.version))),typeof t.callback!="undefined"&&(r.callback=t.callback),this.sendRequest(r)},__delay:function(){var e=new XMLHttpRequest,t=window.location+"?forcenocache="+TinCan.Utils.getUUID();e.open("GET",t,!1),e.send(null)}}}(),function(){"use strict";var e=TinCan.AgentAccount=function(e){this.log("constructor"),this.homePage=null,this.name=null,this.init(e)};e.prototype={LOG_SRC:"AgentAccount",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["name","homePage"],r;e=e||{},typeof e.accountServiceHomePage!="undefined"&&(e.homePage=e.accountServiceHomePage),typeof e.accountName!="undefined"&&(e.name=e.accountName);for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]])},toString:function(e){this.log("toString");var t="";return this.name!==null||this.homePage!==null?(t+=this.name!==null?this.name:"-",t+=":",t+=this.homePage!==null?this.homePage:"-"):t="AgentAccount: unidentified",t},asVersion:function(e){this.log("asVersion: "+e);var t={};return e=e||TinCan.versions()[0],e==="0.9"?(t.accountName=this.name,t.accountServiceHomePage=this.homePage):(t.name=this.name,t.homePage=this.homePage),t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.Agent=function(e){this.log("constructor"),this.name=null,this.mbox=null,this.mbox_sha1sum=null,this.openid=null,this.account=null,this.degraded=!1,this.init(e)};e.prototype={objectType:"Agent",LOG_SRC:"Agent",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["name","mbox","mbox_sha1sum","openid"],r;e=e||{};if(typeof e.lastName!="undefined"||typeof e.firstName!="undefined")e.name="",typeof e.firstName!="undefined"&&e.firstName.length>0&&(e.name=e.firstName[0],e.firstName.length>1&&(this.degraded=!0)),e.name!==""&&(e.name+=" "),typeof e.lastName!="undefined"&&e.lastName.length>0&&(e.name+=e.lastName[0],e.lastName.length>1&&(this.degraded=!0));else if(typeof e.familyName!="undefined"||typeof e.givenName!="undefined")e.name="",typeof e.givenName!="undefined"&&e.givenName.length>0&&(e.name=e.givenName[0],e.givenName.length>1&&(this.degraded=!0)),e.name!==""&&(e.name+=" "),typeof e.familyName!="undefined"&&e.familyName.length>0&&(e.name+=e.familyName[0],e.familyName.length>1&&(this.degraded=!0));typeof e.name=="object"&&e.name!==null&&(e.name.length>1&&(this.degraded=!0),e.name=e.name[0]),typeof e.mbox=="object"&&e.mbox!==null&&(e.mbox.length>1&&(this.degraded=!0),e.mbox=e.mbox[0]),typeof e.mbox_sha1sum=="object"&&e.mbox_sha1sum!==null&&(e.mbox_sha1sum.length>1&&(this.degraded=!0),e.mbox_sha1sum=e.mbox_sha1sum[0]),typeof e.openid=="object"&&e.openid!==null&&(e.openid.length>1&&(this.degraded=!0),e.openid=e.openid[0]),typeof e.account=="object"&&e.account!==null&&typeof e.account.homePage=="undefined"&&typeof e.account.name=="undefined"&&(e.account.length===0?delete e.account:(e.account.length>1&&(this.degraded=!0),e.account=e.account[0])),e.hasOwnProperty("account")&&(e.account instanceof TinCan.AgentAccount?this.account=e.account:this.account=new TinCan.AgentAccount(e.account));for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(r=e[n[t]],n[t]==="mbox"&&r.indexOf("mailto:")===-1&&(r="mailto:"+r),this[n[t]]=r)},toString:function(e){return this.log("toString"),this.name!==null?this.name:this.mbox!==null?this.mbox.replace("mailto:",""):this.mbox_sha1sum!==null?this.mbox_sha1sum:this.openid!==null?this.openid:this.account!==null?this.account.toString():this.objectType+": unidentified"},asVersion:function(e){this.log("asVersion: "+e);var t={objectType:this.objectType};return e=e||TinCan.versions()[0],e==="0.9"?(this.mbox!==null?t.mbox=[this.mbox]:this.mbox_sha1sum!==null?t.mbox_sha1sum=[this.mbox_sha1sum]:this.openid!==null?t.openid=[this.openid]:this.account!==null&&(t.account=[this.account.asVersion(e)]),this.name!==null&&(t.name=[this.name])):(this.mbox!==null?t.mbox=this.mbox:this.mbox_sha1sum!==null?t.mbox_sha1sum=this.mbox_sha1sum:this.openid!==null?t.openid=this.openid:this.account!==null&&(t.account=this.account.asVersion(e)),this.name!==null&&(t.name=this.name)),t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.Group=function(e){this.log("constructor"),this.name=null,this.mbox=null,this.mbox_sha1sum=null,this.openid=null,this.account=null,this.member=[],this.init(e)};e.prototype={objectType:"Group",LOG_SRC:"Group",log:TinCan.prototype.log,init:function(e){this.log("init");var t;e=e||{},TinCan.Agent.prototype.init.call(this,e);if(typeof e.member!="undefined")for(t=0;t<e.member.length;t+=1)e.member[t]instanceof TinCan.Agent?this.member.push(e.member[t]):this.member.push(new TinCan.Agent(e.member[t]))},toString:function(e){this.log("toString");var t=TinCan.Agent.prototype.toString.call(this,e);return t!==this.objectType+": unidentified"&&(t=this.objectType+": "+t),t},asVersion:function(e){this.log("asVersion: "+e);var t,n;e=e||TinCan.versions()[0],t=TinCan.Agent.prototype.asVersion.call(this,e);if(this.member.length>0){t.member=[];for(n=0;n<this.member.length;n+=1)t.member.push(this.member[n].asVersion(e))}return t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e={"http://adlnet.gov/expapi/verbs/experienced":"experienced","http://adlnet.gov/expapi/verbs/attended":"attended","http://adlnet.gov/expapi/verbs/attempted":"attempted","http://adlnet.gov/expapi/verbs/completed":"completed","http://adlnet.gov/expapi/verbs/passed":"passed","http://adlnet.gov/expapi/verbs/failed":"failed","http://adlnet.gov/expapi/verbs/answered":"answered","http://adlnet.gov/expapi/verbs/interacted":"interacted","http://adlnet.gov/expapi/verbs/imported":"imported","http://adlnet.gov/expapi/verbs/created":"created","http://adlnet.gov/expapi/verbs/shared":"shared","http://adlnet.gov/expapi/verbs/voided":"voided"},t=TinCan.Verb=function(e){this.log("constructor"),this.id=null,this.display=null,this.init(e)};t.prototype={LOG_SRC:"Verb",log:TinCan.prototype.log,init:function(t){this.log("init");var n,r=["id","display"],i;if(typeof t=="string"){this.id=t,this.display={und:this.id};for(i in e)if(e.hasOwnProperty(i)&&e[i]===t){this.id=i;break}}else{t=t||{};for(n=0;n<r.length;n+=1)t.hasOwnProperty(r[n])&&t[r[n]]!==null&&(this[r[n]]=t[r[n]]);this.display===null&&typeof e[this.id]!="undefined"&&(this.display={und:e[this.id]})}},toString:function(e){return this.log("toString"),this.display!==null?this.getLangDictionaryValue("display",e):this.id},asVersion:function(t){this.log("asVersion");var n;return t=t||TinCan.versions()[0],t==="0.9"?n=e[this.id]:(n={id:this.id},this.display!==null&&(n.display=this.display)),n},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue},t.fromJSON=function(e){t.prototype.log("fromJSON");var n=JSON.parse(e);return new t(n)}}(),function(){"use strict";var e=TinCan.Result=function(e){this.log("constructor"),this.score=null,this.success=null,this.completion=null,this.duration=null,this.response=null,this.extensions=null,this.init(e)};e.prototype={LOG_SRC:"Result",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["completion","duration","extensions","response","success"];e=e||{},e.hasOwnProperty("score")&&e.score!==null&&(e.score instanceof TinCan.Score?this.score=e.score:this.score=new TinCan.Score(e.score));for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]]);this.completion==="Completed"&&(this.completion=!0)},asVersion:function(e){this.log("asVersion");var t={},n=["success","duration","response","extensions"],r=["score"],i,s;e=e||TinCan.versions()[0];for(i=0;i<n.length;i+=1)this[n[i]]!==null&&(t[n[i]]=this[n[i]]);for(i=0;i<r.length;i+=1)this[r[i]]!==null&&(t[r[i]]=this[r[i]].asVersion(e));return this.completion!==null&&(e==="0.9"?this.completion&&(t.completion="Completed"):t.completion=this.completion),t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.Score=function(e){this.log("constructor"),this.scaled=null,this.raw=null,this.min=null,this.max=null,this.init(e)};e.prototype={LOG_SRC:"Score",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["scaled","raw","min","max"];e=e||{};for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]])},asVersion:function(e){this.log("asVersion");var t={},n=["scaled","raw","min","max"],r,i;e=e||TinCan.versions()[0];for(r=0;r<n.length;r+=1)this[n[r]]!==null&&(t[n[r]]=this[n[r]]);return t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.InteractionComponent=function(e){this.log("constructor"),this.id=null,this.description=null,this.init(e)};e.prototype={LOG_SRC:"InteractionComponent",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["id","description"];e=e||{};for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]])},asVersion:function(e){this.log("asVersion");var t={id:this.id},n=["description"],r,i;e=e||TinCan.versions()[0];for(r=0;r<n.length;r+=1)i=n[r],this[i]!==null&&(t[i]=this[i]);return t},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e={"http://adlnet.gov/expapi/activities/course":"course","http://adlnet.gov/expapi/activities/module":"module","http://adlnet.gov/expapi/activities/meeting":"meeting","http://adlnet.gov/expapi/activities/media":"media","http://adlnet.gov/expapi/activities/performance":"performance","http://adlnet.gov/expapi/activities/simulation":"simulation","http://adlnet.gov/expapi/activities/assessment":"assessment","http://adlnet.gov/expapi/activities/interaction":"interaction","http://adlnet.gov/expapi/activities/cmi.interaction":"cmi.interaction","http://adlnet.gov/expapi/activities/question":"question","http://adlnet.gov/expapi/activities/objective":"objective","http://adlnet.gov/expapi/activities/link":"link"},t=TinCan.ActivityDefinition=function(e){this.log("constructor"),this.name=null,this.description=null,this.type=null,this.moreInfo=null,this.extensions=null,this.interactionType=null,this.correctResponsesPattern=null,this.choices=null,this.scale=null,this.source=null,this.target=null,this.steps=null,this.init(e)};t.prototype={LOG_SRC:"ActivityDefinition",log:TinCan.prototype.log,init:function(t){this.log("init");var n,r,i,s=["name","description","moreInfo","extensions","correctResponsesPattern"],o=[];t=t||{};if(t.hasOwnProperty("type")&&t.type!==null){for(i in e)e.hasOwnProperty(i)&&e[i]===t.type&&(t.type=e[i]);this.type=t.type}if(t.hasOwnProperty("interactionType")&&t.interactionType!==null){this.interactionType=t.interactionType,t.interactionType==="choice"||t.interactionType==="sequencing"?o.push("choices"):t.interactionType==="likert"?o.push("scale"):t.interactionType==="matching"?(o.push("source"),o.push("target")):t.interactionType==="performance"&&o.push("steps");if(o.length>0)for(n=0;n<o.length;n+=1){i=o[n];if(t.hasOwnProperty(i)&&t[i]!==null){this[i]=[];for(r=0;r<t[i].length;r+=1)t[i][r]instanceof TinCan.InteractionComponent?this[i].push(t[i][r]):this[i].push(new TinCan.InteractionComponent(t[i][r]))}}}for(n=0;n<s.length;n+=1)t.hasOwnProperty(s[n])&&t[s[n]]!==null&&(this[s[n]]=t[s[n]])},toString:function(e){return this.log("toString"),this.name!==null?this.getLangDictionaryValue("name",e):this.description!==null?this.getLangDictionaryValue("description",e):""},asVersion:function(t){this.log("asVersion");var n={},r=["name","description","interactionType","correctResponsesPattern","extensions"],i=["choices","scale","source","target","steps"],s,o,u;t=t||TinCan.versions()[0],this.type!==null&&(t==="0.9"?n.type=e[this.type]:n.type=this.type);for(s=0;s<r.length;s+=1)u=r[s],this[u]!==null&&(n[u]=this[u]);for(s=0;s<i.length;s+=1){u=i[s];if(this[u]!==null){n[u]=[];for(o=0;o<this[u].length;o+=1)n[u].push(this[u][o].asVersion(t))}}return t.indexOf("0.9")!==0&&this.moreInfo!==null&&(n.moreInfo=this.moreInfo),n},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue},t.fromJSON=function(e){t.prototype.log("fromJSON");var n=JSON.parse(e);return new t(n)}}(),function(){"use strict";var e=TinCan.Activity=function(e){this.log("constructor"),this.objectType="Activity",this.id=null,this.definition=null,this.init(e)};e.prototype={LOG_SRC:"Activity",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["id"];e=e||{},e.hasOwnProperty("definition")&&(e.definition instanceof TinCan.ActivityDefinition?this.definition=e.definition:this.definition=new TinCan.ActivityDefinition(e.definition));for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]])},toString:function(e){this.log("toString");var t="";if(this.definition!==null){t=this.definition.toString(e);if(t!=="")return t}return this.id!==null?this.id:"Activity: unidentified"},asVersion:function(e){this.log("asVersion");var t={id:this.id,objectType:this.objectType};return e=e||TinCan.versions()[0],this.definition!==null&&(t.definition=this.definition.asVersion(e)),t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.ContextActivities=function(e){this.log("constructor"),this.parent=null,this.grouping=null,this.other=null,this.init(e)};e.prototype={LOG_SRC:"ContextActivities",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n,r=["parent","grouping","other"],i,s;e=e||{};for(t=0;t<r.length;t+=1){i=r[t];if(e.hasOwnProperty(i)&&e[i]!==null)if(Object.prototype.toString.call(e[i])==="[object Array]")for(n=0;n<e[i].length;n+=1)this.add(i,e[i][n]);else s=e[i],this.add(i,s)}},add:function(e,t){if(e!=="parent"&&e!=="grouping"&&e!=="other")return;return this[e]===null&&(this[e]=[]),t instanceof TinCan.Activity||(t=typeof t=="string"?{id:t}:t,t=new TinCan.Activity(t)),this[e].push(t),this[e].length-1},asVersion:function(e){this.log("asVersion");var t={},n=["parent","grouping","other"],r,i,s;e=e||TinCan.versions()[0];for(r=0;r<n.length;r+=1)if(this[n[r]]!==null&&this[n[r]].length>0)if(e==="0.9"||e==="0.95")this[n[r]].length>1&&this.log("[WARNING] version does not support multiple values in: "+n[r]),t[n[r]]=this[n[r]][0].asVersion(e);else{t[n[r]]=[];for(i=0;i<this[n[r]].length;i+=1)t[n[r]].push(this[n[r]][i].asVersion(e))}return t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.Context=function(e){this.log("constructor"),this.registration=null,this.instructor=null,this.team=null,this.contextActivities=null,this.revision=null,this.platform=null,this.language=null,this.statement=null,this.extensions=null,this.init(e)};e.prototype={LOG_SRC:"Context",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["registration","revision","platform","language","statement","extensions"],r=["instructor","team"],i,s;e=e||{};for(t=0;t<n.length;t+=1)i=n[t],e.hasOwnProperty(i)&&e[i]!==null&&(this[i]=e[i]);for(t=0;t<r.length;t+=1){i=r[t];if(e.hasOwnProperty(i)&&e[i]!==null){s=e[i];if(typeof s.objectType=="undefined"||s.objectType==="Person")s.objectType="Agent";s.objectType!=="Agent"||s instanceof TinCan.Agent?s.objectType==="Group"&&!(s instanceof TinCan.Group)&&(s=new TinCan.Group(s)):s=new TinCan.Agent(s),this[i]=s}}e.hasOwnProperty("contextActivities")&&e.contextActivities!==null&&(e.contextActivities instanceof TinCan.ContextActivities?this.contextActivities=e.contextActivities:this.contextActivities=new TinCan.ContextActivities(e.contextActivities))},asVersion:function(e){this.log("asVersion");var t={},n=["registration","revision","platform","language","extensions"],r=["instructor","team","contextActivities","statement"],i,s;e=e||TinCan.versions()[0];for(i=0;i<n.length;i+=1)this[n[i]]!==null&&(t[n[i]]=this[n[i]]);for(i=0;i<r.length;i+=1)this[r[i]]!==null&&(t[r[i]]=this[r[i]].asVersion(e));return t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.StatementRef=function(e){this.log("constructor"),this.id=null,this.init(e)};e.prototype={objectType:"StatementRef",LOG_SRC:"StatementRef",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["id"],r;e=e||{};for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]])},toString:function(e){return this.log("toString"),this.id},asVersion:function(e){this.log("asVersion");var t={objectType:this.objectType,id:this.id};return e==="0.9"&&(t.objectType="Statement"),t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.SubStatement=function(e){this.log("constructor"),this.actor=null,this.verb=null,this.target=null,this.result=null,this.context=null,this.timestamp=null,this.init(e)};e.prototype={objectType:"SubStatement",LOG_SRC:"SubStatement",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["timestamp"],r;e=e||{},e.hasOwnProperty("object")&&(e.target=e.object);if(e.hasOwnProperty("actor")){if(typeof e.actor.objectType=="undefined"||e.actor.objectType==="Person")e.actor.objectType="Agent";e.actor.objectType==="Agent"?e.actor instanceof TinCan.Agent?this.actor=e.actor:this.actor=new TinCan.Agent(e.actor):e.actor.objectType==="Group"&&(e.actor instanceof TinCan.Group?this.actor=e.actor:this.actor=new TinCan.Group(e.actor))}e.hasOwnProperty("verb")&&(e.verb instanceof TinCan.Verb?this.verb=e.verb:this.verb=new TinCan.Verb(e.verb)),e.hasOwnProperty("target")&&(e.target instanceof TinCan.Activity||e.target instanceof TinCan.Agent||e.target instanceof TinCan.Group||e.target instanceof TinCan.SubStatement||e.target instanceof TinCan.StatementRef?this.target=e.target:(typeof e.target.objectType=="undefined"&&(e.target.objectType="Activity"),e.target.objectType==="Activity"?this.target=new TinCan.Activity(e.target):e.target.objectType==="Agent"?this.target=new TinCan.Agent(e.target):e.target.objectType==="Group"?this.target=new TinCan.Group(e.target):e.target.objectType==="SubStatement"?this.target=new TinCan.SubStatement(e.target):e.target.objectType==="StatementRef"?this.target=new TinCan.StatementRef(e.target):this.log("Unrecognized target type: "+e.target.objectType))),e.hasOwnProperty("result")&&(e.result instanceof TinCan.Result?this.result=e.result:this.result=new TinCan.Result(e.result)),e.hasOwnProperty("context")&&(e.context instanceof TinCan.Context?this.context=e.context:this.context=new TinCan.Context(e.context));for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]])},toString:function(e){return this.log("toString"),(this.actor!==null?this.actor.toString(e):"")+" "+(this.verb!==null?this.verb.toString(e):"")+" "+(this.target!==null?this.target.toString(e):"")},asVersion:function(e){this.log("asVersion");var t,n=["timestamp"],r=["result","context"],i;e=e||TinCan.versions()[0],t={objectType:this.objectType,actor:this.actor.asVersion(e),verb:this.verb.asVersion(e),object:this.target.asVersion(e)};for(i=0;i<n.length;i+=1)this[n[i]]!==null&&(t[n[i]]=this[n[i]]);for(i=0;i<r.length;i+=1)this[r[i]]!==null&&(t[r[i]]=this[r[i]].asVersion(e));return t}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.Statement=function(e,t){this.log("constructor"),typeof t=="number"?t={storeOriginal:t}:t=t||{},typeof t.storeOriginal=="undefined"&&(t.storeOriginal=null),typeof t.doStamp=="undefined"&&(t.doStamp=!0),this.id=null,this.actor=null,this.verb=null,this.target=null,this.result=null,this.context=null,this.timestamp=null,this.stored=null,this.authority=null,this.version=null,this.degraded=!1,this.voided=null,this.inProgress=null,this.originalJSON=null,this.init(e,t)};e.prototype={LOG_SRC:"Statement",log:TinCan.prototype.log,init:function(e,t){this.log("init");var n,r=["id","stored","timestamp","version","inProgress","voided"],i;e=e||{},t.storeOriginal&&(this.originalJSON=JSON.stringify(e,null,t.storeOriginal)),e.hasOwnProperty("object")&&(e.target=e.object);if(e.hasOwnProperty("actor")){if(typeof e.actor.objectType=="undefined"||e.actor.objectType==="Person")e.actor.objectType="Agent";e.actor.objectType==="Agent"?e.actor instanceof TinCan.Agent?this.actor=e.actor:this.actor=new TinCan.Agent(e.actor):e.actor.objectType==="Group"&&(e.actor instanceof TinCan.Group?this.actor=e.actor:this.actor=new TinCan.Group(e.actor))}if(e.hasOwnProperty("authority")){if(typeof e.authority.objectType=="undefined"||e.authority.objectType==="Person")e.authority.objectType="Agent";e.authority.objectType==="Agent"?e.authority instanceof TinCan.Agent?this.authority=e.authority:this.authority=new TinCan.Agent(e.authority):e.authority.objectType==="Group"&&(e.actor instanceof TinCan.Group?this.authority=e.authority:this.authority=new TinCan.Group(e.authority))}e.hasOwnProperty("verb")&&(e.verb instanceof TinCan.Verb?this.verb=e.verb:this.verb=new TinCan.Verb(e.verb)),e.hasOwnProperty("target")&&(e.target instanceof TinCan.Activity||e.target instanceof TinCan.Agent||e.target instanceof TinCan.Group||e.target instanceof TinCan.SubStatement||e.target instanceof TinCan.StatementRef?this.target=e.target:(typeof e.target.objectType=="undefined"&&(e.target.objectType="Activity"),e.target.objectType==="Activity"?this.target=new TinCan.Activity(e.target):e.target.objectType==="Agent"?this.target=new TinCan.Agent(e.target):e.target.objectType==="Group"?this.target=new TinCan.Group(e.target):e.target.objectType==="SubStatement"?this.target=new TinCan.SubStatement(e.target):e.target.objectType==="StatementRef"?this.target=new TinCan.StatementRef(e.target):this.log("Unrecognized target type: "+e.target.objectType))),e.hasOwnProperty("result")&&(e.result instanceof TinCan.Result?this.result=e.result:this.result=new TinCan.Result(e.result)),e.hasOwnProperty("context")&&(e.context instanceof TinCan.Context?this.context=e.context:this.context=new TinCan.Context(e.context));for(n=0;n<r.length;n+=1)e.hasOwnProperty(r[n])&&e[r[n]]!==null&&(this[r[n]]=e[r[n]]);t.doStamp&&this.stamp()},toString:function(e){return this.log("toString"),(this.actor!==null?this.actor.toString(e):"")+" "+(this.verb!==null?this.verb.toString(e):"")+" "+(this.target!==null?this.target.toString(e):"")},asVersion:function(e){this.log("asVersion");var t={},n=["id","timestamp"],r=["actor","verb","result","context","authority"],i;e=e||TinCan.versions()[0];for(i=0;i<n.length;i+=1)this[n[i]]!==null&&(t[n[i]]=this[n[i]]);for(i=0;i<r.length;i+=1)this[r[i]]!==null&&(t[r[i]]=this[r[i]].asVersion(e));return this.target!==null&&(t.object=this.target.asVersion(e)),(e==="0.9"||e==="0.95")&&this.voided!==null&&(t.voided=this.voided),e==="0.9"&&this.inProgress!==null&&(t.inProgress=this.inProgress),t},stamp:function(){this.log("stamp"),this.id===null&&(this.id=TinCan.Utils.getUUID()),this.timestamp===null&&(this.timestamp=TinCan.Utils.getISODateString(new Date))}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.StatementsResult=function(e){this.log("constructor"),this.statements=null,this.more=null,this.init(e)};e.prototype={LOG_SRC:"StatementsResult",log:TinCan.prototype.log,init:function(e){this.log("init"),e=e||{},e.hasOwnProperty("statements")&&(this.statements=e.statements),e.hasOwnProperty("more")&&(this.more=e.more)}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n,r=[],i,s;try{n=JSON.parse(t)}catch(o){e.prototype.log("fromJSON - JSON.parse error: "+o)}if(n){for(s=0;s<n.statements.length;s+=1){try{i=new TinCan.Statement(n.statements[s],4)}catch(u){e.prototype.log("fromJSON - statement instantiation failed: "+u+" ("+JSON.stringify(n.statements[s])+")"),i=new TinCan.Statement({id:n.statements[s].id},4)}r.push(i)}n.statements=r}return new e(n)}}(),function(){"use strict";var e=TinCan.State=function(e){this.log("constructor"),this.id=null,this.updated=null,this.contents=null,this.etag=null,this.contentType=null,this.init(e)};e.prototype={LOG_SRC:"State",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["id","contents","etag","contentType"],r;e=e||{};for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]]);this.updated=!1}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.ActivityProfile=function(e){this.log("constructor"),this.id=null,this.activity=null,this.updated=null,this.contents=null,this.etag=null,this.contentType=null,this.init(e)};e.prototype={LOG_SRC:"ActivityProfile",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["id","contents","etag","contentType"],r;e=e||{},e.hasOwnProperty("activity")&&(e.activity instanceof TinCan.Activity?this.activity=e.activity:this.activity=new TinCan.Activity(e.activity));for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]]);this.updated=!1}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}(),function(){"use strict";var e=TinCan.AgentProfile=function(e){this.log("constructor"),this.id=null,this.agent=null,this.updated=null,this.contents=null,this.etag=null,this.contentType=null,this.init(e)};e.prototype={LOG_SRC:"AgentProfile",log:TinCan.prototype.log,init:function(e){this.log("init");var t,n=["id","contents","etag","contentType"],r;e=e||{},e.hasOwnProperty("agent")&&(e.agent instanceof TinCan.Agent?this.agent=e.agent:this.agent=new TinCan.Agent(e.agent));for(t=0;t<n.length;t+=1)e.hasOwnProperty(n[t])&&e[n[t]]!==null&&(this[n[t]]=e[n[t]]);this.updated=!1}},e.fromJSON=function(t){e.prototype.log("fromJSON");var n=JSON.parse(t);return new e(n)}}();var CryptoJS=CryptoJS||function(e,t){var n={},r=n.lib={},i=r.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.$super.extend(this)}}}(),s=r.WordArray=i.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,e=e.sigBytes;this.clamp();if(r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return s.create(n,t)}}),o=n.enc={},u=o.Hex={stringify:function(e){for(var t=e.words,e=e.sigBytes,n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((i&15).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return s.create(n,t/2)}},a=o.Latin1={stringify:function(e){for(var t=e.words,e=e.sigBytes,n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(e.charCodeAt(r)&255)<<24-8*(r%4);return s.create(n,t)}},f=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(a.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return a.parse(unescape(encodeURIComponent(e)))}},l=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=s.create(),this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,u=i/(4*o),u=t?e.ceil(u):e.max((u|0)-this._minBufferSize,0),t=u*o,i=e.min(4*t,i);if(t){for(var a=0;a<t;a+=o)this._doProcessBlock(r,a);a=r.splice(0,t),n.sigBytes-=i}return s.create(a,i)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=l.extend({init:function(){this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize(),this._hash},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:16,_createHelper:function(e){return function(t,n){return e.create(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return c.HMAC.create(e,n).finalize(t)}}});var c=n.algo={};return n}(Math);(function(){var e=CryptoJS,t=e.lib,n=t.WordArray,t=t.Hasher,r=[],i=e.algo.SHA1=t.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],s=n[1],o=n[2],u=n[3],a=n[4],f=0;80>f;f++){if(16>f)r[f]=e[t+f]|0;else{var l=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=l<<1|l>>>31}l=(i<<5|i>>>27)+a+r[f],l=20>f?l+((s&o|~s&u)+1518500249):40>f?l+((s^o^u)+1859775393):60>f?l+((s&o|s&u|o&u)-1894007588):l+((s^o^u)-899497514),a=u,u=o,o=s<<30|s>>>2,s=i,i=l}n[0]=n[0]+i|0,n[1]=n[1]+s|0,n[2]=n[2]+o|0,n[3]=n[3]+u|0,n[4]=n[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+15]=n,e.sigBytes=4*t.length,this._process()}});e.SHA1=t._createHelper(i),e.HmacSHA1=t._createHmacHelper(i)})(),function(){var e=CryptoJS,t=e.lib,n=t.WordArray,r=e.enc,i=r.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();var i=[];for(var s=0;s<n;s+=3){var o=t[s>>>2]>>>24-s%4*8&255,u=t[s+1>>>2]>>>24-(s+1)%4*8&255,a=t[s+2>>>2]>>>24-(s+2)%4*8&255,f=o<<16|u<<8|a;for(var l=0;l<4&&s+l*.75<n;l++)i.push(r.charAt(f>>>6*(3-l)&63))}var c=r.charAt(64);if(c)while(i.length%4)i.push(c);return i.join("")},parse:function(e){e=e.replace(/\s/g,"");var t=e.length,r=this._map,i=r.charAt(64);if(i){var s=e.indexOf(i);s!=-1&&(t=s)}var o=[],u=0;for(var a=0;a<t;a++)if(a%4){var f=r.indexOf(e.charAt(a-1))<<a%4*2,l=r.indexOf(e.charAt(a))>>>6-a%4*2;o[u>>>2]|=(f|l)<<24-u%4*8,u++}return n.create(o,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}();
